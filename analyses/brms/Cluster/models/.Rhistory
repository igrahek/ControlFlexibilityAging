sample_prior = TRUE,
cores=4)
saveRDS(efficacy,file="../output/model.efficacy.previous.feedback.rds")
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
### Fit the reward response model ###
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
# Predicting reward probe response by reward and efficacy feedback
reward = brm(RewardProbeResp ~  1 +
Reward_T0 +
Reward_T1 +
Reward_T2 +
Reward_T3 +
Reward_T4 +
Efficacy_T0 +
Efficacy_T1 +
Efficacy_T2 +
Efficacy_T3 +
Efficacy_T4 +
(1|SubID),
data=df.interval.combined[!is.na(df.interval.combined$RewardProbeResp),],
family=gaussian(),
prior = prior,
iter  = 20000,
warmup = 19000,
save_pars=save_pars(all=TRUE),
control = list(adapt_delta = 0.99),
sample_prior = TRUE,
cores=4)
saveRDS(reward,file="../output/model.reward.previous.feedback.rds")
View(df.interval.combined)
hist(df.interval.combined$EfficacyProbeResp)
hist(df.interval.combined[!is.na(df.interval.combined$EfficacyProbeResp),])
df.interval.combined[!is.na(df.interval.combined$EfficacyProbeResp),]
x = df.interval.combined[!is.na(df.interval.combined$EfficacyProbeResp),]
hist(x$EfficacyProbeResp)
View(df.interval.combined)
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
### Import the data ###
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
df.interval.combined = read.csv("../data/Exp2DataInterval.csv")
View(df.interval.combined)
#load packages and install them if they're not installed
if (!require("pacman")) install.packages("pacman")
pacman::p_load(MASS,stats,tidyverse,brms)
# set seed
set.seed(42)
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
### Import the data ###
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
df.interval.combined = read.csv("../data/Exp2DataInterval.csv")
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
### Change the variable names and contrast code ###
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
EfficacyLag = c("Efficacy_T0",
"Efficacy_T1",
"Efficacy_T2",
"Efficacy_T3",
"Efficacy_T4")
df.interval.combined = df.interval.combined %>%
mutate_at(EfficacyLag,funs(recode(.,0 = "NoEfficacy",1 = "Efficacy"))) %>%
mutate_at(EfficacyLag,funs(factor(.)))
#load packages and install them if they're not installed
if (!require("pacman")) install.packages("pacman")
pacman::p_load(MASS,stats,tidyverse,brms)
# set seed
set.seed(42)
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
### Import the data ###
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
df.interval.combined = read.csv("../data/Exp2DataInterval.csv")
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
### Change the variable names and contrast code ###
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
EfficacyLag = c("Efficacy_T0",
"Efficacy_T1",
"Efficacy_T2",
"Efficacy_T3",
"Efficacy_T4")
df.interval.combined = df.interval.combined %>%
mutate_at(EfficacyLag,funs(recode(.,"0" = "NoEfficacy","1" = "Efficacy"))) %>%
mutate_at(EfficacyLag,funs(factor(.)))
#load packages and install them if they're not installed
if (!require("pacman")) install.packages("pacman")
pacman::p_load(MASS,stats,tidyverse,brms)
# set seed
set.seed(42)
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
### Import the data ###
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
df.interval.combined = read.csv("../data/Exp2DataInterval.csv")
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
### Change the variable names and contrast code ###
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
EfficacyLag = c("Efficacy_T0",
"Efficacy_T1",
"Efficacy_T2",
"Efficacy_T3",
"Efficacy_T4")
df.interval.combined = df.interval.combined %>%
mutate_at(EfficacyLag,funs(recode(.,"0" = "NoEfficacy","1" = "Efficacy"))) %>%
mutate_at(EfficacyLag,funs(factor(.)))
# reorder the levels
df.interval.combined$Efficacy_T0 = ordered(df.interval.combined$Efficacy_T0, levels = c("NoEfficacy", "Efficacy"))
df.interval.combined$Efficacy_T1 = ordered(df.interval.combined$Efficacy_T1, levels = c("NoEfficacy", "Efficacy"))
df.interval.combined$Efficacy_T2 = ordered(df.interval.combined$Efficacy_T2, levels = c("NoEfficacy", "Efficacy"))
df.interval.combined$Efficacy_T3 = ordered(df.interval.combined$Efficacy_T3, levels = c("NoEfficacy", "Efficacy"))
df.interval.combined$Efficacy_T4 = ordered(df.interval.combined$Efficacy_T4, levels = c("NoEfficacy", "Efficacy"))
# contrast code
contrasts(df.interval.combined$Efficacy_T0) = contr.sdif(2)
contrasts(df.interval.combined$Efficacy_T1) = contr.sdif(2)
contrasts(df.interval.combined$Efficacy_T2) = contr.sdif(2)
contrasts(df.interval.combined$Efficacy_T3) = contr.sdif(2)
contrasts(df.interval.combined$Efficacy_T4) = contr.sdif(2)
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
### Set the priors###
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
prior = c(
prior(normal(0.5,0.2), class = Intercept), # A wide prior sensible for this type of task
prior(normal(0, 0.2), class = b)) # a wide prior
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
### Fit the efficacy response model ###
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
efficacy = brm(EfficacyProbeResp ~  1 +
Efficacy_T0 +
Efficacy_T1 +
Efficacy_T2 +
Efficacy_T3 +
Efficacy_T4 +
Reward_T0 +
Reward_T1 +
Reward_T2 +
Reward_T3 +
Reward_T4 +
(1|SubID),
data=df.interval.combined[!is.na(df.interval.combined$EfficacyProbeResp),],
family=gaussian(),
prior = prior,
iter  = 20000,
warmup = 19000,
save_pars=save_pars(all=TRUE),
control = list(adapt_delta = 0.99),
sample_prior = TRUE,
cores=4)
saveRDS(efficacy,file="../output/model.efficacy.previous.feedback.rds")
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
### Fit the reward response model ###
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
# Predicting reward probe response by reward and efficacy feedback
reward = brm(RewardProbeResp ~  1 +
Reward_T0 +
Reward_T1 +
Reward_T2 +
Reward_T3 +
Reward_T4 +
Efficacy_T0 +
Efficacy_T1 +
Efficacy_T2 +
Efficacy_T3 +
Efficacy_T4 +
(1|SubID),
data=df.interval.combined[!is.na(df.interval.combined$RewardProbeResp),],
family=gaussian(),
prior = prior,
iter  = 20000,
warmup = 19000,
save_pars=save_pars(all=TRUE),
control = list(adapt_delta = 0.99),
sample_prior = TRUE,
cores=4)
saveRDS(reward,file="../output/model.reward.previous.feedback.rds")
# clear the environment
rm(list=ls())
# set seed
set.seed(42)
#load packages and install them if they're not installed. the pacman package will
#automatically check for the requested packages and download & install them if they are not on the computer.
if (!require("pacman")) install.packages("pacman")
pacman::p_load(brms,here,broom,knitr,tidyverse,plyr,cowplot)
# Define the summary posterior function
summarize_posterior <- function(model,variable) {
post = posterior_samples(model, "^b")
ggplot(post,aes_string(x=paste0("`",variable,"`"))) +
geom_histogram(bins=50) +
geom_vline(xintercept=0, linetype="dotted",size=1) +
labs(title=paste(variable,"p<0 = ",length(subset(post[[variable]],post[[variable]]<0))/length(post[[variable]]))) +
theme_classic()
}
# Define calculate the posterior probabilities function
posterior_probabilities <- function(model) {
parameter_names = rownames(summary(model)[["fixed"]])
post_prob = rep(0,length(parameter_names))
for (i in 1:length(parameter_names)){
t = hypothesis(model,paste0(parameter_names[i],"<0"))
post_prob[i] = t$hypothesis$Post.Prob
}
return(post_prob)
}
setwd(here::here("Experiment2/Analysis/brms/Cluster/output"))
df.trial = read.csv("../data/SpeedAccuracySpeedAcc_nSubs_38.csv")
getwd()
df.trial = read.csv("../data/SpeedAccuracySpeedAcc_nSubs_38.csv")
library("brms")
library("MASS")
# set seed
set.seed(42)
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
### Import the data
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
df.trial= read.csv("../../../../data/ProcessedData/CleanDataSpeedAccuracy_nSubs_246.csv")
df.trial$hit = as.numeric(df.trial$hit)
# Change the name of the congruency variable
df.trial$Congruency = df.trial$type
# Center the continuous variables
df.trial$scaledIntervalLength = scale(df.trial$scaledIntervalLength, scale= TRUE, center = TRUE)
df.trial$scaledIntervalSessionNum = scale(df.trial$scaledIntervalSessionNum, scale= TRUE, center = TRUE)
df.trial$Age = scale(df.trial$Age, scale= TRUE, center = TRUE)
# Make the quadratic age variable
df.trial$Age_2 = df.trial$Age^2
View(df.trial)
colnames(df.trial)
# Contrast code the categorical variables
df.trial$Congruency = ordered(df.trial$type, levels = c("congruent", "incongruent"))
contrasts(df.trial$Congruency) = contr.sdif(2)
colnames(attr(df.trial$Congruency, "contrasts")) =  c("inc_min_con")
df.trial$blockType = ordered(df.trial$blockType, levels = c("Mixed","Fixed"))
contrasts(df.trial$blockType) = contr.sdif(2)
colnames(attr(df.trial$blockType, "contrasts")) =  c("Mixed_min_Fixed")
df.trial$intervalType = ordered(df.trial$intervalType, levels = c("Speed","Accuracy"))
contrasts(df.trial$intervalType) = contr.sdif(2)
colnames(attr(df.trial$intervalType, "contrasts")) =  c("Speed_min_Accuracy")
df.trial$previntervalType = ordered(df.trial$previntervalType, levels = c("Speed","Accuracy"))
contrasts(df.trial$previntervalType) = contr.sdif(2)
colnames(attr(df.trial$previntervalType, "contrasts")) =  c("Speed_min_Accuracy")
df.trial$Switch = ordered(df.trial$Switch, levels = c("Switch","Repeat"))
contrasts(df.trial$Switch) = contr.sdif(2)
colnames(attr(df.trial$Switch, "contrasts")) =  c("Switch_min_Repeat")
df.trial$intervalNumHalf = ifelse(df.trial$intervalNum>15,"Second","First")
df.trial$intervalNumHalf = ordered(df.trial$intervalNumHalf, levels = c("Second","First"))
contrasts(df.trial$intervalNumHalf) = contr.sdif(2)
colnames(attr(df.trial$intervalNumHalf, "contrasts")) =  c("Second_min_First")
library("brms")
library("MASS")
# set seed
set.seed(42)
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
### Import the data
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
df.trial= read.csv("../../../../data/ProcessedData/CleanDataSpeedAccuracy_nSubs_246.csv")
df.trial$hit = as.numeric(df.trial$hit)
# Change the name of the congruency variable
df.trial$Congruency = df.trial$type
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
### Re-scale the data
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
# Center the continuous variables
df.trial$scaledIntervalLength = scale(df.trial$scaledIntervalLength, scale= FALSE, center = TRUE)
df.trial$scaledIntervalSessionNum = scale(df.trial$scaledIntervalSessionNum, scale= FALSE, center = TRUE)
df.trial$scaledRunningTime = scale(df.trial$scaledRunningTime, scale= FALSE, center = TRUE)
df.trial$Age = scale(df.trial$Age, scale= TRUE, center = TRUE)
# Make the quadratic age variable
df.trial$Age_2 = df.trial$Age^2
# Contrast code the categorical variables
df.trial$Congruency = ordered(df.trial$type, levels = c("congruent", "incongruent"))
contrasts(df.trial$Congruency) = contr.sdif(2)
colnames(attr(df.trial$Congruency, "contrasts")) =  c("inc_min_con")
df.trial$blockType = ordered(df.trial$blockType, levels = c("Mixed","Fixed"))
contrasts(df.trial$blockType) = contr.sdif(2)
colnames(attr(df.trial$blockType, "contrasts")) =  c("Mixed_min_Fixed")
df.trial$intervalType = ordered(df.trial$intervalType, levels = c("Speed","Accuracy"))
contrasts(df.trial$intervalType) = contr.sdif(2)
colnames(attr(df.trial$intervalType, "contrasts")) =  c("Speed_min_Accuracy")
df.trial$previntervalType = ordered(df.trial$previntervalType, levels = c("Speed","Accuracy"))
library("brms")
library("MASS")
# set seed
set.seed(42)
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
### Import the data
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
df.trial= read.csv("../../../../data/ProcessedData/CleanDataSpeedAccuracy_nSubs_246.csv")
df.trial$hit = as.numeric(df.trial$hit)
# Change the name of the congruency variable
df.trial$Congruency = df.trial$type
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
### Re-scale the data
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
# Center the continuous variables
df.trial$scaledIntervalLength = scale(df.trial$scaledIntervalLength, scale= FALSE, center = TRUE)
df.trial$scaledIntervalSessionNum = scale(df.trial$scaledIntervalSessionNum, scale= FALSE, center = TRUE)
df.trial$scaledRunningTime = scale(df.trial$scaledRunningTime, scale= FALSE, center = TRUE)
df.trial$Age = scale(df.trial$Age, scale= TRUE, center = TRUE)
# Make the quadratic age variable
df.trial$Age_2 = df.trial$Age^2
# Contrast code the categorical variables
df.trial$Congruency = ordered(df.trial$type, levels = c("congruent", "incongruent"))
contrasts(df.trial$Congruency) = contr.sdif(2)
colnames(attr(df.trial$Congruency, "contrasts")) =  c("inc_min_con")
df.trial$blockType = ordered(df.trial$blockType, levels = c("Mixed","Fixed"))
contrasts(df.trial$blockType) = contr.sdif(2)
colnames(attr(df.trial$blockType, "contrasts")) =  c("Mixed_min_Fixed")
df.trial$intervalType = ordered(df.trial$intervalType, levels = c("Speed","Accuracy"))
contrasts(df.trial$intervalType) = contr.sdif(2)
colnames(attr(df.trial$intervalType, "contrasts")) =  c("Speed_min_Accuracy")
df.trial$previntervalType = ordered(df.trial$previntervalType, levels = c("Speed","Accuracy"))
contrasts(df.trial$previntervalType) = contr.sdif(2)
colnames(attr(df.trial$previntervalType, "contrasts")) =  c("Speed_min_Accuracy")
df.trial$Switch = ordered(df.trial$Switch, levels = c("Switch","Repeat"))
contrasts(df.trial$Switch) = contr.sdif(2)
colnames(attr(df.trial$Switch, "contrasts")) =  c("Switch_min_Repeat")
df.trial$intervalNumHalf = ifelse(df.trial$intervalNum>15,"Second","First")
library("brms")
library("MASS")
# set seed
set.seed(42)
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
### Import the data
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
df.trial= read.csv("../../../../data/ProcessedData/CleanDataSpeedAccuracy_nSubs_246.csv")
df.trial$hit = as.numeric(df.trial$hit)
# Change the name of the congruency variable
df.trial$Congruency = df.trial$type
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
### Re-scale the data
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
# Center the continuous variables
df.trial$scaledIntervalLength = scale(df.trial$scaledIntervalLength, scale= FALSE, center = TRUE)
df.trial$scaledIntervalSessionNum = scale(df.trial$scaledIntervalSessionNum, scale= FALSE, center = TRUE)
df.trial$scaledRunningTime = scale(df.trial$scaledRunningTime, scale= FALSE, center = TRUE)
df.trial$Age = scale(df.trial$Age, scale= TRUE, center = TRUE)
# Make the quadratic age variable
df.trial$Age_2 = df.trial$Age^2
range(df.trial$Age)
range(df.trial$Age,rm.na=T)
range(df.trial$Age,na.rm = =T)
range(df.trial$Age,na.rm = T)
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
### Import the data
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
df.trial= read.csv("../../../../data/ProcessedData/CleanDataSpeedAccuracy_nSubs_246.csv")
View(df.trial)
df.trial= read.csv("../../../../data/ProcessedData/CleanDataSpeedAccuracy_nSubs_245.csv")
# Change the name of the congruency variable
df.trial$Congruency = df.trial$type
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
### Re-scale the data
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
# Center the continuous variables
df.trial$scaledIntervalLength = scale(df.trial$scaledIntervalLength, scale= FALSE, center = TRUE)
df.trial$scaledIntervalSessionNum = scale(df.trial$scaledIntervalSessionNum, scale= FALSE, center = TRUE)
df.trial$scaledRunningTime = scale(df.trial$scaledRunningTime, scale= FALSE, center = TRUE)
# Contrast code the categorical variables
df.trial$Congruency = ordered(df.trial$type, levels = c("congruent", "incongruent"))
contrasts(df.trial$Congruency) = contr.sdif(2)
library("brms")
library("MASS")
# set seed
set.seed(42)
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
### Import the data
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
df.trial= read.csv("../../../../data/ProcessedData/CleanDataSpeedAccuracy_nSubs_245.csv")
# Change the name of the congruency variable
df.trial$Congruency = df.trial$type
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
### Re-scale the data
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
# Center the continuous variables
df.trial$scaledIntervalLength = scale(df.trial$scaledIntervalLength, scale= FALSE, center = TRUE)
df.trial$scaledIntervalSessionNum = scale(df.trial$scaledIntervalSessionNum, scale= FALSE, center = TRUE)
df.trial$scaledRunningTime = scale(df.trial$scaledRunningTime, scale= FALSE, center = TRUE)
# Contrast code the categorical variables
df.trial$Congruency = ordered(df.trial$type, levels = c("congruent", "incongruent"))
contrasts(df.trial$Congruency) = contr.sdif(2)
colnames(attr(df.trial$Congruency, "contrasts")) =  c("inc_min_con")
df.trial$blockType = ordered(df.trial$blockType, levels = c("Mixed","Fixed"))
contrasts(df.trial$blockType) = contr.sdif(2)
colnames(attr(df.trial$blockType, "contrasts")) =  c("Mixed_min_Fixed")
df.trial$intervalType = ordered(df.trial$intervalType, levels = c("Speed","Accuracy"))
contrasts(df.trial$intervalType) = contr.sdif(2)
colnames(attr(df.trial$intervalType, "contrasts")) =  c("Speed_min_Accuracy")
df.trial$previntervalType = ordered(df.trial$previntervalType, levels = c("Speed","Accuracy"))
contrasts(df.trial$previntervalType) = contr.sdif(2)
colnames(attr(df.trial$previntervalType, "contrasts")) =  c("Speed_min_Accuracy")
df.trial$Switch = ordered(df.trial$Switch, levels = c("Switch","Repeat"))
contrasts(df.trial$Switch) = contr.sdif(2)
colnames(attr(df.trial$Switch, "contrasts")) =  c("Switch_min_Repeat")
df.trial$intervalNumHalf = ifelse(df.trial$intervalNum>15,"Second","First")
df.trial$intervalNumHalf = ordered(df.trial$intervalNumHalf, levels = c("Second","First"))
contrasts(df.trial$intervalNumHalf) = contr.sdif(2)
colnames(attr(df.trial$intervalNumHalf, "contrasts")) =  c("Second_min_First")
hist(df.trial$Age)
hist(df.trial$Age_2)
library("brms")
library("MASS")
library(lme4)
# set seed
set.seed(42)
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
### Import the data
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
df.trial= read.csv("../../../../data/ProcessedData/CleanDataSpeedAccuracy_nSubs_245.csv")
df.trial$hit = as.numeric(df.trial$hit)
# Change the name of the congruency variable
df.trial$Congruency = df.trial$type
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
### Re-scale the data
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
# Center the continuous variables
df.trial$scaledIntervalLength = scale(df.trial$scaledIntervalLength, scale= FALSE, center = TRUE)
df.trial$scaledIntervalSessionNum = scale(df.trial$scaledIntervalSessionNum, scale= FALSE, center = TRUE)
df.trial$scaledRunningTime = scale(df.trial$scaledRunningTime, scale= FALSE, center = TRUE)
# Contrast code the categorical variables
df.trial$Congruency = ordered(df.trial$type, levels = c("congruent", "incongruent"))
contrasts(df.trial$Congruency) = contr.sdif(2)
colnames(attr(df.trial$Congruency, "contrasts")) =  c("inc_min_con")
df.trial$blockType = ordered(df.trial$blockType, levels = c("Mixed","Fixed"))
contrasts(df.trial$blockType) = contr.sdif(2)
colnames(attr(df.trial$blockType, "contrasts")) =  c("Mixed_min_Fixed")
df.trial$intervalType = ordered(df.trial$intervalType, levels = c("Speed","Accuracy"))
contrasts(df.trial$intervalType) = contr.sdif(2)
colnames(attr(df.trial$intervalType, "contrasts")) =  c("Speed_min_Accuracy")
df.trial$previntervalType = ordered(df.trial$previntervalType, levels = c("Speed","Accuracy"))
contrasts(df.trial$previntervalType) = contr.sdif(2)
colnames(attr(df.trial$previntervalType, "contrasts")) =  c("Speed_min_Accuracy")
df.trial$Switch = ordered(df.trial$Switch, levels = c("Switch","Repeat"))
contrasts(df.trial$Switch) = contr.sdif(2)
colnames(attr(df.trial$Switch, "contrasts")) =  c("Switch_min_Repeat")
df.trial$intervalNumHalf = ifelse(df.trial$intervalNum>15,"Second","First")
df.trial$intervalNumHalf = ordered(df.trial$intervalNumHalf, levels = c("Second","First"))
contrasts(df.trial$intervalNumHalf) = contr.sdif(2)
colnames(attr(df.trial$intervalNumHalf, "contrasts")) =  c("Second_min_First")
model.accrt = lmer(rt ~ Congruency + intervalType*blockType*Age + intervalType*blockType*Age_2 + scaledIntervalSessionNum + scaledIntervalLength + scaledRunningTime + (1|uniqueid),data = df.trial, REML = F)
summary(model.accrt)
hist(df.trial$Age)
mean(df.trial$Age)
mean(df.trial$Age_2)
hist(df.trial$Age_2)
df.trial= read.csv("../../../../data/ProcessedData/CleanDataSpeedAccuracy_nSubs_246.csv")
# Center the continuous variables
df.trial$scaledIntervalLength = scale(df.trial$scaledIntervalLength, scale= FALSE, center = TRUE)
df.trial$scaledIntervalSessionNum = scale(df.trial$scaledIntervalSessionNum, scale= FALSE, center = TRUE)
df.trial$scaledRunningTime = scale(df.trial$scaledRunningTime, scale= FALSE, center = TRUE)
# Contrast code the categorical variables
df.trial$Congruency = ordered(df.trial$type, levels = c("congruent", "incongruent"))
contrasts(df.trial$Congruency) = contr.sdif(2)
colnames(attr(df.trial$Congruency, "contrasts")) =  c("inc_min_con")
df.trial$blockType = ordered(df.trial$blockType, levels = c("Mixed","Fixed"))
contrasts(df.trial$blockType) = contr.sdif(2)
colnames(attr(df.trial$blockType, "contrasts")) =  c("Mixed_min_Fixed")
df.trial$intervalType = ordered(df.trial$intervalType, levels = c("Speed","Accuracy"))
contrasts(df.trial$intervalType) = contr.sdif(2)
colnames(attr(df.trial$intervalType, "contrasts")) =  c("Speed_min_Accuracy")
df.trial$previntervalType = ordered(df.trial$previntervalType, levels = c("Speed","Accuracy"))
contrasts(df.trial$previntervalType) = contr.sdif(2)
colnames(attr(df.trial$previntervalType, "contrasts")) =  c("Speed_min_Accuracy")
df.trial$Switch = ordered(df.trial$Switch, levels = c("Switch","Repeat"))
contrasts(df.trial$Switch) = contr.sdif(2)
colnames(attr(df.trial$Switch, "contrasts")) =  c("Switch_min_Repeat")
df.trial$intervalNumHalf = ifelse(df.trial$intervalNum>15,"Second","First")
df.trial$intervalNumHalf = ordered(df.trial$intervalNumHalf, levels = c("Second","First"))
contrasts(df.trial$intervalNumHalf) = contr.sdif(2)
colnames(attr(df.trial$intervalNumHalf, "contrasts")) =  c("Second_min_First")
model.accrt = lmer(rt ~ Congruency + intervalType*blockType*poly(Age,2) + scaledIntervalSessionNum + scaledIntervalLength + scaledRunningTime + (1|uniqueid),data = df.trial, REML = F)
library(MASS)
model.accrt = lmer(rt ~ Congruency + intervalType*blockType*poly(Age,2) + scaledIntervalSessionNum + scaledIntervalLength + scaledRunningTime + (1|uniqueid),data = df.trial, REML = F)
library(stats)
model.accrt = lmer(rt ~ Congruency + intervalType*blockType*poly(Age,2) + scaledIntervalSessionNum + scaledIntervalLength + scaledRunningTime + (1|uniqueid),data = df.trial, REML = F)
df.trial <- df.trial[complete.cases(df.trial$Age), ]
model.accrt = lmer(rt ~ Congruency + intervalType*blockType*poly(Age,2) + scaledIntervalSessionNum + scaledIntervalLength + scaledRunningTime + (1|uniqueid),data = df.trial, REML = F)
sumary(model.accrt)
summary(model.accrt)
df.trial$Age_scaled = scale(df.trial$Age,center=T,scale=T)
model.accrt = lmer(rt ~ Congruency + intervalType*blockType*poly(Age_scaled,2) + scaledIntervalSessionNum + scaledIntervalLength + scaledRunningTime + (1|uniqueid),data = df.trial, REML = F)
summary(model.accrt)
model.accrt = lmer(rt ~ Congruency + intervalType*blockType*poly(Age_scaled,2) + scaledIntervalSessionNum + scaledIntervalLength + scaledRunningTime + (1|uniqueid),data = df.trial, REML = F)
summary(model.accrt)
model.accrt = lmer(rt ~ Congruency + intervalType*blockType*poly(Age,2) + scaledIntervalSessionNum + scaledIntervalLength + scaledRunningTime + (1|uniqueid),data = df.trial, REML = F)
summary(model.accrt)
model.accrt = lmer(rt ~ Congruency + intervalType*blockType*poly(Age,2,raw=T) + scaledIntervalSessionNum + scaledIntervalLength + scaledRunningTime + (1|uniqueid),data = df.trial, REML = F)
summary(model.accrt)
df.trial <- df.trial[complete.cases(df.trial$Age), ]
df.trial$Age_scaled = scale(df.trial$Age,center=T,scale=T)
model.accrt = lmer(rt ~ Congruency + intervalType*blockType*poly(Age,2,raw=T) + scaledIntervalSessionNum + scaledIntervalLength + scaledRunningTime + (1|uniqueid),data = df.trial, REML = F)
summary(model.accrt)
model.accrt = lmer(rt ~ Congruency + intervalType*blockType*poly(Age,2) + scaledIntervalSessionNum + scaledIntervalLength + scaledRunningTime + (1|uniqueid),data = df.trial, REML = F)
contr.sdiff
?contrasts
contrasts.sdiff
contr.sum
contr.sdif
# set seed
set.seed(42)
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
### Import the data
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
df.trial= read.csv("../../../../data/ProcessedData/CleanDataSpeedAccuracy_nSubs_245.csv")
df.trial$hit = as.numeric(df.trial$hit)
# Change the name of the congruency variable
df.trial$Congruency = df.trial$type
# Re-scale the age variables so that they are not very small
df.trial$Age = df.trial$Age * 100
df.trial$Age_2 = df.trial$Age_2 * 100
range(df.trial$Age)
range(df.trial$Age_2)
mean(df.trial$Age)
mean(df.trial$Age_2)
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
df.trial= read.csv("../../../../data/ProcessedData/CleanDataSpeedAccuracy_nSubs_245.csv")
df.trial$hit = as.numeric(df.trial$hit)
# Change the name of the congruency variable
df.trial$Congruency = df.trial$type
range(df.trial$Age)
